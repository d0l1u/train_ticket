<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="hcp">
	<!-- 当前打码人数 -->
	<select id="queryAdminCurrentNameCount" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM (SELECT username,real_name FROM rh_user WHERE login_status='1'  
		AND DATE_FORMAT(last_login_time,'%Y-%m-%d')=DATE_FORMAT(CURDATE(),'%Y-%m-%d')) AS temp
	</select>
	
	<!-- 查询当天打码总数信息 -->
	<select id="queryCodeCountToday" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM rh_picture WHERE DATE_FORMAT(create_time,'%Y-%m-%d')=DATE_FORMAT(NOW(),'%Y-%m-%d') 
		AND opt_ren IN (SELECT username FROM rh_user )
	</select>
	
	<!-- 查询当天打码正确1总数信息 -->
	<select id="queryCodeToday" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM rh_picture WHERE DATE_FORMAT(create_time,'%Y-%m-%d')=DATE_FORMAT(NOW(),'%Y-%m-%d') 
		AND result_status='1' AND opt_ren IN (SELECT username FROM rh_user )
	</select>

	<!-- 获取当前日期距07:00:00的分钟数 -->
	<select id="queryMinutes" resultClass="java.lang.Integer">
		SELECT TRUNCATE((UNIX_TIMESTAMP(NOW())-UNIX_TIMESTAMP(CONCAT(CURDATE(),' 07:00:00')))/60,0);
	</select>
	
	<!-- 前1天打码正确总数 -->
	<select id="querySuccess1" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM rh_picture WHERE finish_time <![CDATA[<=]]> SUBDATE(NOW(),INTERVAL 1 DAY) 
		AND DATE_FORMAT(create_time,'%Y-%m-%d')=DATE_FORMAT(SUBDATE(NOW(),INTERVAL 1 DAY),'%Y-%m-%d') 
		AND result_status='1' AND opt_ren IN (SELECT username FROM rh_user )
	</select>
	
	<!-- 前2天打码正确总数 -->
	<select id="querySuccess2" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM rh_picture WHERE finish_time <![CDATA[<=]]> SUBDATE(NOW(),INTERVAL 2 DAY) 
		AND DATE_FORMAT(create_time,'%Y-%m-%d')=DATE_FORMAT(SUBDATE(NOW(),INTERVAL 2 DAY),'%Y-%m-%d') 
		AND result_status='1' AND opt_ren IN (SELECT username FROM rh_user )
	</select>
	
	<!-- 当前未打码数 -->
	<select id="queryUncode" resultClass="java.lang.Integer"  parameterClass="java.lang.String" >
		select count(*) from rh_picture where finish_time is null and effect_time > now() and channel=#channel#
	</select>
	
		<!-- 当前未打码数 -->
	<select id="codeQunarType" resultClass="java.lang.String"  parameterClass="java.lang.String" >
		select setting_value from train_system_setting where setting_name='qunar_play_code'
	</select>
	
</sqlMap>