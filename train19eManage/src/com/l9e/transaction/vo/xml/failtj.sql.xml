<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="failtj">

	<!-- 获取按条件查询所有 -->
	<select id="queryFailtjList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
			  tj_id,
			  DATE_FORMAT(create_time, '%Y-%m-%d %H:%i:%s') create_time,
			  DATE_FORMAT(create_time, '%Y-%m-%d') create_time2,
			  DATE_FORMAT(create_time, '%d') create_time3,
			  channel,cgl,
			  count,all_order,zhanbi,
			   zhanbi_1,zhanbi_2,zhanbi_3,zhanbi_4,zhanbi_5,zhanbi_6,zhanbi_7,zhanbi_8,zhanbi_9,zhanbi_11,zhanbi_12,zhanbi_0,
			  fail_1,fail_2,fail_3,fail_4,fail_5,fail_6,fail_7,fail_8,fail_9,fail_11,fail_12,fail_0 
			  FROM
			  tj_failorder 
			WHERE 1 = 1 
			<dynamic prepend="">
			<isNotEmpty prepend=" and " property="begin_info_time">
				create_time<![CDATA[>=]]>DATE_FORMAT(#begin_info_time#,'%Y-%m-%d %H:%i:%s')
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="end_info_time">
				create_time<![CDATA[<]]>DATE_ADD(DATE_FORMAT(#end_info_time#,'%Y-%m-%d %H:%i:%s'),INTERVAL 1 DAY)
			</isNotEmpty>
			  <isNotEmpty prepend=" and " property="channel">
	         	  channel in
		          <iterate open="(" close=")" conjunction="," property="channel">
		            	#channel[]:VARCHAR#
		      	  </iterate>
	      	  </isNotEmpty>
			</dynamic>
		ORDER BY create_time DESC  LIMIT #everyPagefrom:Integer#,#pageSize:Integer#
	</select>
	

	<!-- 获取按条件查询数 -->
	<select id="queryFailtjCounts"
		parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		SELECT COUNT(*) FROM tj_failorder 
		<dynamic prepend="where">
			<isNotEmpty prepend=" and " property="begin_info_time">
				create_time<![CDATA[>=]]>DATE_FORMAT(#begin_info_time#,'%Y-%m-%d %H:%i:%s')
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="end_info_time">
				create_time<![CDATA[<]]>DATE_ADD(DATE_FORMAT(#end_info_time#,'%Y-%m-%d %H:%i:%s'),INTERVAL 1 DAY)
			</isNotEmpty>
			  <isNotEmpty prepend=" and " property="channel">
	         	  channel in
		          <iterate open="(" close=")" conjunction="," property="channel">
		            	#channel[]:VARCHAR#
		      	  </iterate>
	      	  </isNotEmpty>
		</dynamic>
	</select>


	
	<!-- 导出queryFailtjExcel -->
	<select id="queryFailtjExcel" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			SELECT 
			  tj_id,
			  DATE_FORMAT(create_time, '%Y-%m-%d %H:%i:%s') create_time,
			  channel,cgl,
			  count,all_order,zhanbi,
			   zhanbi_1,zhanbi_2,zhanbi_3,zhanbi_4,zhanbi_5,zhanbi_6,zhanbi_7,zhanbi_8,zhanbi_9,zhanbi_11,zhanbi_12,zhanbi_0,
			  fail_1,fail_2,fail_3,fail_4,fail_5,fail_6,fail_7,fail_8,fail_9,fail_11,fail_12,fail_0
			  FROM
			  tj_failorder 
			WHERE 1 = 1 
			<dynamic prepend=" ">
			<isNotEmpty prepend=" and " property="begin_info_time">
				create_time<![CDATA[>=]]>DATE_FORMAT(#begin_info_time#,'%Y-%m-%d %H:%i:%s')
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="end_info_time">
				create_time<![CDATA[<]]>DATE_ADD(DATE_FORMAT(#end_info_time#,'%Y-%m-%d %H:%i:%s'),INTERVAL 1 DAY)
			</isNotEmpty>
			  <isNotEmpty prepend=" and " property="channel">
	         	  channel in
		          <iterate open="(" close=")" conjunction="," property="channel">
		            	#channel[]:VARCHAR#
		      	  </iterate>
	      	  </isNotEmpty>
			</dynamic>
			ORDER BY create_time DESC
	</select>

</sqlMap>