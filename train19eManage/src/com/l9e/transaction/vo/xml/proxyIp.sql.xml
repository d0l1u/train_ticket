<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="proxyIp">

	<insert id="addProxyIps" parameterClass="com.l9e.transaction.vo.ProxyIpVo">
		INSERT INTO proxy_ip
		(
		order_id,
		username,
		password,
		port,
		ip,
		create_time,
		end_time
		)
		VALUES
		<iterate conjunction="," property="ipList">
			(
			#orderId#,
			#username#,
			#password#,
			#port#,
			#ipList[]:VARCHAR#,
			#createTime#,
			#endTime#
			)
		</iterate>
	</insert>

	<select id="queryListProxyIp" parameterClass="com.l9e.transaction.qo.ProxyIpQO"
		resultClass="com.l9e.transaction.vo.ProxyIpVo">
		SELECT
		auto_id AS autoId,
		ip,
		port,
		username,
		password,
		create_time AS createTime,
		status,
		reason,
		order_id AS orderId,
		end_time AS endTime
		FROM proxy_ip
		WHERE 1=1
		<dynamic prepend="">
			<isNotEmpty prepend=" and " property="orderId">
				order_id = #orderId#
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="ip">
				ip = #ip#
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="beginCreateTime">
				create_time <![CDATA[>=]]>
				#beginCreateTime#
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="endCreateTime">
				create_time <![CDATA[<=]]>
				#endCreateTime#
			</isNotEmpty>

			<isNotEmpty prepend=" and " property="beginEndTime">
				end_time <![CDATA[>=]]>
				#beginEndTime#
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="endEndTime">
				end_time <![CDATA[<=]]>
				#endEndTime#
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="status">
				status = #status#
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="beginIndex">
			LIMIT #beginIndex#
			<isNotEmpty prepend=" , " property="endIndex">
				#endIndex#
			</isNotEmpty>
		</isNotEmpty>

	</select>

	<select id="queryTotalCount" parameterClass="com.l9e.transaction.qo.ProxyIpQO"
		resultClass="java.lang.Integer">
		SELECT
		count(auto_id)
		FROM proxy_ip
		WHERE 1=1
		<dynamic prepend="">
			<isNotEmpty prepend=" and " property="orderId">
				order_id = #orderId#
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="ip">
				ip = #ip#
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="beginCreateTime">
				create_time <![CDATA[>=]]>
				#beginCreateTime#
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="endCreateTime">
				create_time <![CDATA[<=]]>
				#endCreateTime#
			</isNotEmpty>

			<isNotEmpty prepend=" and " property="beginEndTime">
				end_time <![CDATA[>=]]>
				#beginEndTime#
			</isNotEmpty>
			<isNotEmpty prepend=" and " property="endEndTime">
				end_time <![CDATA[<=]]>
				#endEndTime#
			</isNotEmpty>
		</dynamic>

	</select>


	<delete id="deleteListByIds" parameterClass="java.util.List">
		DELETE FROM proxy_ip WHERE auto_id IN
		<iterate conjunction="," open="(" close=")">
			#[]#
		</iterate>
	</delete>
	
	<update id="updateListByIds" parameterClass="java.util.HashMap" >
		UPDATE 
			proxy_ip 
		<dynamic prepend="SET">
			<isNotEmpty prepend=" , " property="ipVo.orderId">
				order_id = #ipVo.orderId#
			</isNotEmpty>
			<isNotEmpty prepend=" , " property="ipVo.endTime">
				end_time = #ipVo.endTime#
			</isNotEmpty>
			<isNotEmpty prepend=" , " property="ipVo.status">
				status = #ipVo.status#
			</isNotEmpty>
		</dynamic>
		WHERE auto_id IN
		<iterate property="idList" open="(" close=")" conjunction=",">  
            #idList[]#  
        </iterate>  
			
	</update>


</sqlMap>